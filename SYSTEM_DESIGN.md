# システム方式設計（暫定）

本書はシステム設計の内部工程である「システム方式設計」を扱う。要件は `SYSTEM_REQUIREMENTS.md` を参照。
ソフトウェア側の方式設計/詳細設計は `SOFTWARE_ARCHITECTURE.md` / `SOFTWARE_DETAILED_DESIGN.md` を参照。

## 全体アーキテクチャ
- クライアント: Flutter（Androidを先行、将来iOS対応）
- 動作方針: offline-first（端末内で記録・閲覧・集計が完結）
- 構成（概念）: UI（画面）→ アプリケーション層 → 永続化（ローカルDB）/集計

## 技術選定（推奨）
### 決定
- ローカルDB: SQLite + `drift`
- 状態管理: `riverpod`

### 補足（なぜ必要か）
- SQLite: 端末内で「構造化された記録（Plan/Session/PB）」を永続化し、検索・集計（週負荷/移動平均/強度分布など）を安定して行うための土台。
- drift: SQLiteをFlutterから扱いやすくし、型安全なクエリとスキーマ更新（マイグレーション）を提供するために使う。
- riverpod: 画面（UI）とデータ取得/計算（DB・負荷計算）を分離し、依存関係のある画面（カレンダー→日詳細→編集）の更新を安全に行うために使う。

## 主要画面（高レベル）
- カレンダー（月）
  - 日セル: 「最大負荷の1件」＋「件数バッジ」
  - 背景濃淡: 日単位代表負荷（合計）を能力推定で相対化した値
- 日詳細
  - その日のセッション一覧（予定/実績、負荷内訳）
  - 追加/編集への導線
- 予定作成（Plan）
- 実績入力（Session）
- 設定（PB、濃淡スケールの設定、エクスポート等）
